import{E as $e,g as ie}from"./strings-DD5QiEz8.js";import{A as we,H as x,_ as te,ai as Se,a3 as be,bl as De,U as Ne,a9 as Me,a0 as Ve,ac as ne,aK as de,P as _e,a4 as ae,b0 as Pe,F as Ae,Y as Te,G as W,cT as Ie,R as Oe,bL as Fe,an as B,cO as Q,cP as He,O as Be}from"./index-fcef7efe-Cx8TW6Jf.js";import{d as J,ad as ze,ai as qe,b as L,c as _,o as k,O as I,G as O,f as Z,Y as ce,w as q,e as Ke,J as w,P as Y,j as ye,a as N,Z as Ce,g as re,t as ue,B as Ee,r as z,i as Ue,A as Ze,R as he,v as ee,am as je,p as Re,q as Ge}from"./app-D_2IkvLF.js";import{E as Ye}from"./index-v8HcONvJ.js";import{E as xe}from"./index-BSpCoGCq.js";import{i as R}from"./isEqual-w_kfwtk5.js";import{b as Je,U as pe,C as fe}from"./index-D8obs_VI.js";var Xe=1,We=4;function Qe(e){return we(e,Xe|We)}var en=1/0;function nn(e){var n=e==null?0:e.length;return n?Je(e,en):[]}function an(e){return!!(e!=null&&e.every(n=>n.type===qe))}var sn=J({name:"NodeContent",setup(){return{ns:x("cascader-node")}},render(){const{ns:e}=this,{node:n,panel:a}=this.$parent,{data:s,label:t}=n,{renderLabelFn:i}=a,o=()=>{let c=i==null?void 0:i({node:n,data:s});return an(c)&&(c=t),c??t};return ze("span",{class:e.e("label")},o())}});const le=Symbol(),tn=J({name:"ElCascaderNode",components:{ElCheckbox:Ye,ElRadio:xe,NodeContent:sn,ElIcon:Ne,Check:De,Loading:be,ArrowRight:Se},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:n}){const a=ye(le),s=x("cascader-node"),t=N(()=>a.isHoverMenu),i=N(()=>a.config.multiple),o=N(()=>a.config.checkStrictly),c=N(()=>{var p;return(p=a.checkedNodes[0])==null?void 0:p.uid}),u=N(()=>e.node.isDisabled),h=N(()=>e.node.isLeaf),f=N(()=>o.value&&!h.value||!u.value),b=N(()=>K(a.expandingNode)),y=N(()=>o.value&&a.checkedNodes.some(K)),K=p=>{var E;const{level:T,uid:X}=e.node;return((E=p==null?void 0:p.pathNodes[T-1])==null?void 0:E.uid)===X},S=()=>{b.value||a.expandNode(e.node)},F=p=>{const{node:E}=e;p!==E.checked&&a.handleCheckChange(E,p)},$=()=>{a.lazyLoad(e.node,()=>{h.value||S()})},P=p=>{t.value&&(A(),!h.value&&n("expand",p))},A=()=>{const{node:p}=e;!f.value||p.loading||(p.loaded?S():$())},H=()=>{t.value&&!h.value||(h.value&&!u.value&&!o.value&&!i.value?D(!0):A())},U=p=>{o.value?(F(p),e.node.loaded&&S()):D(p)},D=p=>{e.node.loaded?(F(p),!o.value&&S()):$()};return{panel:a,isHoverMenu:t,multiple:i,checkStrictly:o,checkedNodeId:c,isDisabled:u,isLeaf:h,expandable:f,inExpandingPath:b,inCheckedPath:y,ns:s,handleHoverExpand:P,handleExpand:A,handleClick:H,handleCheck:D,handleSelectCheck:U}}});function ln(e,n,a,s,t,i){const o=L("el-checkbox"),c=L("el-radio"),u=L("check"),h=L("el-icon"),f=L("node-content"),b=L("loading"),y=L("arrow-right");return k(),_("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?void 0:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:w([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[I(" prefix "),e.multiple?(k(),O(o,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:ce(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(k(),O(c,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:ce(()=>{},["stop"])},{default:q(()=>[I(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Ke("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(k(),O(h,{key:2,class:w(e.ns.e("prefix"))},{default:q(()=>[Z(u)]),_:1},8,["class"])):I("v-if",!0),I(" content "),Z(f),I(" postfix "),e.isLeaf?I("v-if",!0):(k(),_(Y,{key:3},[e.node.loading?(k(),O(h,{key:0,class:w([e.ns.is("loading"),e.ns.e("postfix")])},{default:q(()=>[Z(b)]),_:1},8,["class"])):(k(),O(h,{key:1,class:w(["arrow-right",e.ns.e("postfix")])},{default:q(()=>[Z(y)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var on=te(tn,[["render",ln],["__file","node.vue"]]);const dn=J({name:"ElCascaderMenu",components:{Loading:be,ElIcon:Ne,ElScrollbar:$e,ElCascaderNode:on},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const n=Ue(),a=x("cascader-menu"),{t:s}=Me(),t=Ve();let i=null,o=null;const c=ye(le),u=z(null),h=N(()=>!e.nodes.length),f=N(()=>!c.initialLoaded),b=N(()=>`${t.value}-${e.index}`),y=$=>{i=$.target},K=$=>{if(!(!c.isHoverMenu||!i||!u.value))if(i.contains($.target)){S();const P=n.vnode.el,{left:A}=P.getBoundingClientRect(),{offsetWidth:H,offsetHeight:U}=P,D=$.clientX-A,p=i.offsetTop,E=p+i.offsetHeight;u.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${D} ${p} L${H} 0 V${p} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${D} ${E} L${H} ${U} V${E} Z" />
        `}else o||(o=window.setTimeout(F,c.config.hoverThreshold))},S=()=>{o&&(clearTimeout(o),o=null)},F=()=>{u.value&&(u.value.innerHTML="",S())};return{ns:a,panel:c,hoverZone:u,isEmpty:h,isLoading:f,menuId:b,t:s,handleExpand:y,handleMouseMove:K,clearHoverZone:F}}});function cn(e,n,a,s,t,i){const o=L("el-cascader-node"),c=L("loading"),u=L("el-icon"),h=L("el-scrollbar");return k(),O(h,{key:e.menuId,tag:"ul",role:"menu",class:w(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:q(()=>{var f;return[(k(!0),_(Y,null,Ce(e.nodes,b=>(k(),O(o,{key:b.uid,node:b,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(k(),_("div",{key:0,class:w(e.ns.e("empty-text"))},[Z(u,{size:"14",class:w(e.ns.is("loading"))},{default:q(()=>[Z(c)]),_:1},8,["class"]),re(" "+ue(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(k(),_("div",{key:1,class:w(e.ns.e("empty-text"))},[Ee(e.$slots,"empty",{},()=>[re(ue(e.t("el.cascader.noData")),1)])],2)):(f=e.panel)!=null&&f.isHoverMenu?(k(),_(Y,{key:2},[I(" eslint-disable-next-line vue/html-self-closing "),(k(),_("svg",{ref:"hoverZone",class:w(e.ns.e("hover-zone"))},null,2))],2112)):I("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var rn=te(dn,[["render",cn],["__file","menu.vue"]]);let un=0;const hn=e=>{const n=[e];let{parent:a}=e;for(;a;)n.unshift(a),a=a.parent;return n};class j{constructor(n,a,s,t=!1){this.data=n,this.config=a,this.parent=s,this.root=t,this.uid=un++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:i,label:o,children:c}=a,u=n[c],h=hn(this);this.level=t?0:s?s.level+1:1,this.value=n[i],this.label=n[o],this.pathNodes=h,this.pathValues=h.map(f=>f.value),this.pathLabels=h.map(f=>f.label),this.childrenData=u,this.children=(u||[]).map(f=>new j(f,a,this)),this.loaded=!a.lazy||this.isLeaf||!ne(u)}get isDisabled(){const{data:n,parent:a,config:s}=this,{disabled:t,checkStrictly:i}=s;return(de(t)?t(n,this):!!n[t])||!i&&(a==null?void 0:a.isDisabled)}get isLeaf(){const{data:n,config:a,childrenData:s,loaded:t}=this,{lazy:i,leaf:o}=a,c=de(o)?o(n,this):n[o];return _e(c)?i&&!t?!1:!(ae(s)&&s.length):!!c}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(n){const{childrenData:a,children:s}=this,t=new j(n,this.config,this);return ae(a)?a.push(n):this.childrenData=[n],s.push(t),t}calcText(n,a){const s=n?this.pathLabels.join(a):this.label;return this.text=s,s}broadcast(n,...a){const s=`onParent${ie(n)}`;this.children.forEach(t=>{t&&(t.broadcast(n,...a),t[s]&&t[s](...a))})}emit(n,...a){const{parent:s}=this,t=`onChild${ie(n)}`;s&&(s[t]&&s[t](...a),s.emit(n,...a))}onParentCheck(n){this.isDisabled||this.setCheckState(n)}onChildCheck(){const{children:n}=this,a=n.filter(t=>!t.isDisabled),s=a.length?a.every(t=>t.checked):!1;this.setCheckState(s)}setCheckState(n){const a=this.children.length,s=this.children.reduce((t,i)=>{const o=i.checked?1:i.indeterminate?.5:0;return t+o},0);this.checked=this.loaded&&this.children.filter(t=>!t.isDisabled).every(t=>t.loaded&&t.checked)&&n,this.indeterminate=this.loaded&&s!==a&&s>0}doCheck(n){if(this.checked===n)return;const{checkStrictly:a,multiple:s}=this.config;a||!s?this.checked=n:(this.broadcast("check",n),this.setCheckState(n),this.emit("check"))}}const se=(e,n)=>e.reduce((a,s)=>(s.isLeaf?a.push(s):(!n&&a.push(s),a=a.concat(se(s.children,n))),a),[]);class ve{constructor(n,a){this.config=a;const s=(n||[]).map(t=>new j(t,this.config));this.nodes=s,this.allNodes=se(s,!1),this.leafNodes=se(s,!0)}getNodes(){return this.nodes}getFlattedNodes(n){return n?this.leafNodes:this.allNodes}appendNode(n,a){const s=a?a.appendChild(n):new j(n,this.config);a||this.nodes.push(s),this.appendAllNodesAndLeafNodes(s)}appendNodes(n,a){n.forEach(s=>this.appendNode(s,a))}appendAllNodesAndLeafNodes(n){this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n),n.children&&n.children.forEach(a=>{this.appendAllNodesAndLeafNodes(a)})}getNodeByValue(n,a=!1){return Pe(n)?null:this.getFlattedNodes(a).find(t=>R(t.value,n)||R(t.pathValues,n))||null}getSameNode(n){return n&&this.getFlattedNodes(!1).find(({value:s,level:t})=>R(n.value,s)&&n.level===t)||null}}const pn=Ae({modelValue:{type:W([Number,String,Array])},options:{type:W(Array),default:()=>[]},props:{type:W(Object),default:()=>({})}}),fn={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:Te,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},vn=e=>N(()=>({...fn,...e.props})),me=e=>{if(!e)return 0;const n=e.id.split("-");return Number(n[n.length-2])},mn=e=>{if(!e)return;const n=e.querySelector("input");n?n.click():Ie(e)&&e.click()},gn=(e,n)=>{const a=n.slice(0),s=a.map(i=>i.uid),t=e.reduce((i,o)=>{const c=s.indexOf(o.uid);return c>-1&&(i.push(o),a.splice(c,1),s.splice(c,1)),i},[]);return t.push(...a),t},ge=e=>[...new Set(e)],ke=e=>!e&&e!==0?[]:ae(e)?e:[e],kn=J({name:"ElCascaderPanel",components:{ElCascaderMenu:rn},props:{...pn,border:{type:Boolean,default:!0},renderLabel:Function},emits:[pe,fe,"close","expand-change"],setup(e,{emit:n,slots:a}){let s=!1;const t=x("cascader"),i=vn(e);let o=null;const c=z(!0),u=z([]),h=z(null),f=z([]),b=z(null),y=z([]),K=N(()=>i.value.expandTrigger==="hover"),S=N(()=>e.renderLabel||a.default),F=()=>{const{options:l}=e,d=i.value;s=!1,o=new ve(l,d),f.value=[o.getNodes()],d.lazy&&ne(e.options)?(c.value=!1,$(void 0,r=>{r&&(o=new ve(r,d),f.value=[o.getNodes()]),c.value=!0,T(!1,!0)})):T(!1,!0)},$=(l,d)=>{const r=i.value;l=l||new j({},r,void 0,!0),l.loading=!0;const v=m=>{const g=l,M=g.root?null:g;m&&(o==null||o.appendNodes(m,M)),g.loading=!1,g.loaded=!0,g.childrenData=g.childrenData||[],d&&d(m)};r.lazyLoad(l,v)},P=(l,d)=>{var r;const{level:v}=l,m=f.value.slice(0,v);let g;l.isLeaf?g=l.pathNodes[v-2]:(g=l,m.push(l.children)),((r=b.value)==null?void 0:r.uid)!==(g==null?void 0:g.uid)&&(b.value=l,f.value=m,!d&&n("expand-change",(l==null?void 0:l.pathValues)||[]))},A=(l,d,r=!0)=>{const{checkStrictly:v,multiple:m}=i.value,g=y.value[0];s=!0,!m&&(g==null||g.doCheck(!1)),l.doCheck(d),E(),r&&!m&&!v&&n("close"),!r&&!m&&!v&&H(l)},H=l=>{l&&(l=l.parent,H(l),l&&P(l))},U=l=>o==null?void 0:o.getFlattedNodes(l),D=l=>{var d;return(d=U(l))==null?void 0:d.filter(r=>r.checked!==!1)},p=()=>{y.value.forEach(l=>l.doCheck(!1)),E(),f.value=f.value.slice(0,1),b.value=null,n("expand-change",[])},E=()=>{var l;const{checkStrictly:d,multiple:r}=i.value,v=y.value,m=D(!d),g=gn(v,m),M=g.map(C=>C.valueByOption);y.value=g,h.value=r?M:(l=M[0])!=null?l:null},T=(l=!1,d=!1)=>{const{modelValue:r}=e,{lazy:v,multiple:m,checkStrictly:g}=i.value,M=!g;if(!(!c.value||s||!d&&R(r,h.value)))if(v&&!l){const G=ge(nn(ke(r))).map(V=>o==null?void 0:o.getNodeByValue(V)).filter(V=>!!V&&!V.loaded&&!V.loading);G.length?G.forEach(V=>{$(V,()=>T(!1,d))}):T(!0,d)}else{const C=m?ke(r):[r],G=ge(C.map(V=>o==null?void 0:o.getNodeByValue(V,M)));X(G,d),h.value=Qe(r)}},X=(l,d=!0)=>{const{checkStrictly:r}=i.value,v=y.value,m=l.filter(C=>!!C&&(r||C.isLeaf)),g=o==null?void 0:o.getSameNode(b.value),M=d&&g||m[0];M?M.pathNodes.forEach(C=>P(C,!0)):b.value=null,v.forEach(C=>C.doCheck(!1)),he(m).forEach(C=>C.doCheck(!0)),y.value=m,Ge(oe)},oe=()=>{Oe&&u.value.forEach(l=>{const d=l==null?void 0:l.$el;if(d){const r=d.querySelector(`.${t.namespace.value}-scrollbar__wrap`),v=d.querySelector(`.${t.b("node")}.${t.is("active")}:last-child`)||d.querySelector(`.${t.b("node")}.in-active-path`);Fe(r,v)}})},Le=l=>{const d=l.target,{code:r}=l;switch(r){case B.up:case B.down:{l.preventDefault();const v=r===B.up?-1:1;Q(He(d,v,`.${t.b("node")}[tabindex="-1"]`));break}case B.left:{l.preventDefault();const v=u.value[me(d)-1],m=v==null?void 0:v.$el.querySelector(`.${t.b("node")}[aria-expanded="true"]`);Q(m);break}case B.right:{l.preventDefault();const v=u.value[me(d)+1],m=v==null?void 0:v.$el.querySelector(`.${t.b("node")}[tabindex="-1"]`);Q(m);break}case B.enter:case B.numpadEnter:mn(d);break}};return Ze(le,he({config:i,expandingNode:b,checkedNodes:y,isHoverMenu:K,initialLoaded:c,renderLabelFn:S,lazyLoad:$,expandNode:P,handleCheckChange:A})),ee([i,()=>e.options],F,{deep:!0,immediate:!0}),ee(()=>e.modelValue,()=>{s=!1,T()},{deep:!0}),ee(()=>h.value,l=>{R(l,e.modelValue)||(n(pe,l),n(fe,l))}),je(()=>u.value=[]),Re(()=>!ne(e.modelValue)&&T()),{ns:t,menuList:u,menus:f,checkedNodes:y,handleKeyDown:Le,handleCheckChange:A,getFlattedNodes:U,getCheckedNodes:D,clearCheckedNodes:p,calculateCheckedValue:E,scrollToExpandingNode:oe}}});function bn(e,n,a,s,t,i){const o=L("el-cascader-menu");return k(),_("div",{class:w([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(k(!0),_(Y,null,Ce(e.menus,(c,u)=>(k(),O(o,{key:u,ref_for:!0,ref:h=>e.menuList[u]=h,index:u,nodes:[...c]},{empty:q(()=>[Ee(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var Nn=te(kn,[["render",bn],["__file","index.vue"]]);const Dn=Be(Nn);export{le as C,fn as D,Dn as E,Qe as a,pn as b,ke as c,vn as u};
